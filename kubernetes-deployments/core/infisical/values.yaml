nameOverride: "infisical"
fullnameOverride: "infisical"

infisical:
  enabled: true
  name: infisical
  autoDatabaseSchemaMigration: true
  fullnameOverride: ""
  podAnnotations: {}
  deploymentAnnotations: {}
  replicaCount: 6

  databaseSchemaMigrationJob:
    image:
      # -- Image repository for migration wait job
      repository: ghcr.io/groundnuty/k8s-wait-for
      # -- Image tag version
      tag: no-root-v2.0
      # -- Pulls image only if not present on the node
      pullPolicy: IfNotPresent

  image:
    repository: infisical/infisical
    tag: "v0.46.2-postgres"
    pullPolicy: IfNotPresent
  serviceAccount:
    create: true  # Ensure this is defined

  affinity: {}

  kubeSecretRef: "infisical-secrets"

  service:
    annotations: {}
    type: LoadBalancer
    annotations:
      metallb.universe.tf/ip-allocated-from-pool: ip-pool
      metallb.universe.tf/loadBalancerIPs: 192.168.1.70

  resources:
    limits:
      memory: 210Mi
    requests:
      cpu: 200m

ingress:
  enabled: false
  hostName: ""
  ingressClassName: traefik
  nginx:
    enabled: false
  annotations: {}
  tls: []

postgresql:
  enabled: true
  name: "postgresql"
  fullnameOverride: "postgresql"
  auth:
    username: infisical
    password: root
    database: infisicalDB
  primary:
    persistence:
      enabled: true
      mountPath: "/postgres"
  useExistingPostgresSecret:
    enabled: false  # or false, depending on your setup

redis:
  enabled: true
  name: "redis"
  fullnameOverride: "redis"
  cluster:
    enabled: false
  usePassword: true
  auth:
    password: "mysecretpassword"
  architecture: standalone
  master:
    persistence:
      enabled: true
      path: "/bitnami/postgresql/data"
